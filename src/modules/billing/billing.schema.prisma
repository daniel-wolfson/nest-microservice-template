// This file is auto-generated by Prisma. Add billing models to your schema.prisma file.

// Add these models to your main schema.prisma file:

/*
model BillingUser {
  id            String          @id @default(cuid())
  userId        String          @unique // Reference to main User table
  customerId    String?         @unique // Stripe customer ID
  balance       Float           @default(0)
  currency      String          @default("USD")
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  subscriptions Subscription[]
  transactions  Transaction[]
  invoices      Invoice[]
  virtualAccounts VirtualAccount[]

  @@map("billing_users")
}

model Subscription {
  id                String        @id @default(cuid())
  billingUserId     String
  stripeSubscriptionId String?    @unique
  stripePriceId     String?
  planId            String
  planName          String
  status            SubscriptionStatus @default(PENDING)
  currentPeriodStart DateTime?
  currentPeriodEnd   DateTime?
  cancelAtPeriodEnd Boolean       @default(false)
  canceledAt        DateTime?
  trialStart        DateTime?
  trialEnd          DateTime?
  metadata          Json?
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  billingUser       BillingUser   @relation(fields: [billingUserId], references: [id], onDelete: Cascade)

  @@index([billingUserId])
  @@index([stripeSubscriptionId])
  @@map("subscriptions")
}

enum SubscriptionStatus {
  PENDING
  ACTIVE
  PAST_DUE
  CANCELED
  INCOMPLETE
  INCOMPLETE_EXPIRED
  TRIALING
  UNPAID
}

model Transaction {
  id              String            @id @default(cuid())
  billingUserId   String
  type            TransactionType
  amount          Float
  currency        String            @default("USD")
  status          TransactionStatus @default(PENDING)
  state           TransactionState  @default(CREATED)
  stripePaymentIntentId String?     @unique
  paymentMethodId String?
  description     String?
  metadata        Json?
  errorMessage    String?
  idempotencyKey  String?           @unique
  invoiceId       String?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  completedAt     DateTime?
  billingUser     BillingUser       @relation(fields: [billingUserId], references: [id], onDelete: Cascade)
  invoice         Invoice?          @relation(fields: [invoiceId], references: [id])

  @@index([billingUserId])
  @@index([stripePaymentIntentId])
  @@index([idempotencyKey])
  @@map("transactions")
}

enum TransactionType {
  DEPOSIT
  WITHDRAWAL
  SUBSCRIPTION
  REFUND
  ADJUSTMENT
  PAYMENT
}

enum TransactionStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  CANCELED
  REFUNDED
}

enum TransactionState {
  CREATED
  PROCESSING
  COMPLETED
  ERROR
  CANCELED
}

model Invoice {
  id                String         @id @default(cuid())
  billingUserId     String
  invoiceNumber     String         @unique
  stripeInvoiceId   String?        @unique
  amount            Float
  currency          String         @default("USD")
  status            InvoiceStatus  @default(DRAFT)
  dueDate           DateTime?
  paidAt            DateTime?
  description       String?
  metadata          Json?
  pdfUrl            String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  billingUser       BillingUser    @relation(fields: [billingUserId], references: [id], onDelete: Cascade)
  transactions      Transaction[]

  @@index([billingUserId])
  @@index([invoiceNumber])
  @@map("invoices")
}

enum InvoiceStatus {
  DRAFT
  OPEN
  PAID
  VOID
  UNCOLLECTIBLE
}

model VirtualAccount {
  id              String    @id @default(cuid())
  billingUserId   String
  accountNumber   String    @unique
  balance         Float     @default(0)
  currency        String    @default("USD")
  status          VirtualAccountStatus @default(ACTIVE)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  billingUser     BillingUser @relation(fields: [billingUserId], references: [id], onDelete: Cascade)

  @@index([billingUserId])
  @@index([accountNumber])
  @@map("virtual_accounts")
}

enum VirtualAccountStatus {
  ACTIVE
  SUSPENDED
  CLOSED
}

model PaymentMethod {
  id                String    @id @default(cuid())
  userId            String
  stripePaymentMethodId String @unique
  type              String    // card, sepa_debit, etc.
  last4             String?
  brand             String?
  expiryMonth       Int?
  expiryYear        Int?
  isDefault         Boolean   @default(false)
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  @@index([userId])
  @@map("payment_methods")
}

model Plan {
  id              String    @id @default(cuid())
  name            String
  description     String?
  stripePriceId   String?   @unique
  amount          Float
  currency        String    @default("USD")
  interval        String    // day, week, month, year
  intervalCount   Int       @default(1)
  trialPeriodDays Int?
  features        Json?
  isActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("plans")
}
*/
